Use Northwind
Go
--1. Create a view named “view_product_order_[your_last_name]”, 
--list all products and total ordered quantity for that product.

create view view_product_order_Gao as
select p.ProductName, Count(o.Quantity) QuantityCount 
from Products p inner join [Order Details] o
on o.ProductID = p.ProductID
group by p.ProductName;

Select * from view_product_order_Gao


--2. Create a stored procedure “sp_product_order_quantity_[your_last_name]”
--that accept product id as an input and total quantities of order as output parameter.
create proc spProductOrderQuantity
@id int,
@total int output
as
begin
select @id = view_product_quantity_order_Gao.ProductID
,@total = view_product_quantity_order_Gao.QuantityCount 
from view_product_quantity_order_Gao
where view_product_quantity_order_Gao.ProductID = @id
end

declare @id int, @total int 
exec spProductOrderQuantity @total out 
print @total



--3. Create a stored procedure “sp_product_order_city_[your_last_name]” 
--that accept product name as an input and top 5 cities that ordered most 
--that product combined with the total quantity of that product ordered from 
--that city as output.
create proc sp_product_order_city_gao
@productName int out
@top5Cities varchar(40) out
as
begin
select @productName = sp_product_order_city_gao.ProductName,
@top5Cities = sp_product_order_city_gao.QuantityPerUnit
from view_product_quantity_order_Gao
where view_product_quantity_order_Gao.ProductName = @productName
end



--4. Create 2 new tables “people_your_last_name” “city_your_last_name”. 
--City table has two records: {Id:1, City: Seattle}, {Id:2, City: Green Bay}. 
--People has three records: {id:1, Name: Aaron Rodgers, City: 2}, 
--{id:2, Name: Russell Wilson, City:1}, {Id: 3, Name: Jody Nelson, City:2}. 
--Remove city of Seattle. If there was anyone from Seattle, put them into a new city 
--“Madison”. Create a view “Packers_your_name” lists all people from Green Bay. 
--If any error occurred, no changes should be made to DB. 
--(after test) Drop both tables and view.

create table people_gao(id int,name char(20),cityid int)
create table city_gao(cityid int,city char(20))
insert into people_gao(id,name,cityid)values(1,'Aaron Rodgers',2)
insert into people_gao(id,name,cityid)values(2,'Russell Wilson',1)
insert into people_gao(id,name,cityid)values(3,'Jody Nelson',2)
insert into city_gao(cityid,city)values(1,'Settle')
insert into city_gao(cityid,city)values(2,'Green Bay')

create view Packers_celia_gao as
select p.id, p.name from people_gao p inner join city_gao c on p.cityid=c.cityid
where c.city='Green bay'

begin tran rollback
drop table people_gao
drop table city_gao
drop view Packers_celia_gao

--5. Create a stored procedure “sp_birthday_employees_[you_last_name]”
--that creates a new table “birthday_employees_your_last_name” and fill it 
--with all employees that have a birthday on Feb. (Make a screen shot) drop the table. 
--Employee table should not be affected.
Create proc spBirthdayEmployees
@Birthday int out,
@Feb int out
as
begin
Select @Birthday = sp_birthday_employees_Gao.EmployeesBirthDate
,@Feb = sp_birthday_employees_Gao.EmployeesBirthDateFeb
from sp_birthday_employees_Gao
where sp_birthday_employees_Gao.EmployeesBirthDate = @Feb
end

Drop proc spBirthdayEmployees
--Drop table spBirthdayEmployees